<!DOCTYPE HTML>
<html>
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>Stog : Stog-multi-doc</title>
<link href="http://zoggy.github.io/stog/style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="page">
<div class="navbar navbar-fixed-top">
<div class="navbar-inner">
<div class="container">


  <div class="nav-collapse">
    <ul class="nav">
    <li class="&lt;navbar-home/&gt;"><a href="http://zoggy.github.io/stog/index.html">Stog</a></li>
    <li class="&lt;navbar-install/&gt;"><a href="http://zoggy.github.io/stog/install.html">Installation</a></li>
    <li class="&lt;navbar-doc/&gt;"><a href="http://zoggy.github.io/stog/doc.html">Documentation</a></li>
    <li class="active"><a href="http://zoggy.github.io/stog/plugins.html">Plugins</a></li>
    <li class="&lt;navbar-blog/&gt;"><a href="http://zoggy.github.io/stog/blog.html">Blog</a></li>
    <li class="&lt;navbar-about/&gt;"><a href="http://zoggy.github.io/stog/about.html">?</a></li>
  </ul>
  <div class="nav pull-right">  </div>
  </div>

</div>
</div>
</div>

<div id="header">
  
  <a href="http://zoggy.github.io/stog/plugins.html">Plugins</a>
  
  <div class="page-title">Stog-multi-doc</div>
</div>




<p>
This plugin allows the definition of several documents
into one XML file.
</p>

<p>Usage:</p>
<pre class="code-sh">$ stog <span class="hl opt">--</span>package stog.multi<span class="hl opt">-</span>doc ...</pre>

<ul class="toc"><li class="toc-section"><a href="http://zoggy.github.io/stog/plugins/multi-doc.html#example">Example</a></li><li class="toc-section"><a href="http://zoggy.github.io/stog/plugins/multi-doc.html#with-contents">Using &lt;with-contents/&gt;</a></li></ul>
<div class="section"><div class="section-title" id="example">Example</div>
<p>
Suppose we have the following XML document in the
file <code>smallposts.html</code> at the root of a Stog directory:
</p>
<pre class="code-xml"><span class="hl kwa">&lt;multi</span><span class="hl std"> </span><span class="">sets</span><span class="hl std">=</span><span class="hl str">&quot;smallposts&quot;</span><span class="hl kwa">&gt;</span><span class="hl std">
  </span><span class="hl kwa">&lt;smallpost</span><span class="hl std"> </span><span class="">id</span><span class="hl std">=</span><span class="hl str">&quot;post1&quot;</span><span class="hl std"> </span><span class="">title</span><span class="hl std">=</span><span class="hl str">&quot;First post&quot;</span><span class="hl std"> </span><span class="">date</span><span class="hl std">=</span><span class="hl str">&quot;2014/01/21&quot;</span><span class="hl kwa">&gt;</span><span class="hl std">
    The first post ...
  </span><span class="hl kwa">&lt;/smallpost</span><span class="hl kwa">&gt;</span><span class="hl std">
  </span><span class="hl kwa">&lt;smallpost</span><span class="hl std"> </span><span class="">id</span><span class="hl std">=</span><span class="hl str">&quot;post2&quot;</span><span class="hl std"> </span><span class="">title</span><span class="hl std">=</span><span class="hl str">&quot;Second post&quot;</span><span class="hl std"> </span><span class="">date</span><span class="hl std">=</span><span class="hl str">&quot;2014/01/22&quot;</span><span class="hl kwa">&gt;</span><span class="hl std">
    The second post ...
  </span><span class="hl kwa">&lt;/smallpost</span><span class="hl kwa">&gt;</span><span class="hl std">
  </span><span class="hl kwa">&lt;contents</span><span class="hl std"> </span><span class="">type</span><span class="hl std">=</span><span class="hl str">&quot;page&quot;</span><span class="hl std"> </span><span class="">title</span><span class="hl std">=</span><span class="hl str">&quot;My small posts&quot;</span><span class="hl kwa">&gt;</span><span class="hl std">
    This is the body of the document &quot;/smallpost&quot;.
    We can list our small posts here:
    </span><span class="hl kwa">&lt;documents</span><span class="hl std"> </span><span class="">type</span><span class="hl std">=</span><span class="hl str">&quot;smallpost&quot;</span><span class="hl std"> </span><span class="">set</span><span class="hl std">=</span><span class="hl str">&quot;smallposts&quot;</span><span class="hl kwa">/&gt;</span><span class="hl std">
  </span><span class="hl kwa">&lt;/contents</span><span class="hl kwa">&gt;</span><span class="hl std">
</span><span class="hl kwa">&lt;/multi</span><span class="hl kwa">&gt;</span><span class="hl std">
</span></pre>
<p>
The <code>muti</code> node at the root of the document indicates that
several documents are defined. The whole document is first read as any
other document: it can have attributes specified for the <code>multi</code>
node, and the body is the contents under this node.
</p>
<p>The multi-doc plugin adds a level -10 to cut the documents of type
&quot;multi&quot;. To do so, each root node of the body is read as if it was
in its own file. Here we declare two documents of type &quot;smallpost&quot;,
with titles, dates and bodies. The <span class="icode"><span class="hl kwa">&lt;contents</span><span class="hl kwa">&gt;</span></span> node contains
the body of the document &quot;/smallposts&quot;. The two other documents are named
&quot;/smallposts/post1&quot; and &quot;/smallposts/post2&quot;, from the path of the
document and their respective ids, using a default separator &quot;/&quot;.
The <span class="icode"><span class="hl kwa">&lt;contents</span><span class="hl kwa">&gt;</span></span> node must have a <code>type</code> attribute.
</p>
<p>
All documents share the definitions appearing in the original &quot;multi&quot; document,
here <span class="icode"><span class="hl std">sets=&quot;smallposts&quot;</span></span>.
</p>
</div>

<div class="section"><div class="section-title" id="naming"> </div>
<p>The paths of the created documents are forged from the path of the
&quot;multi&quot; document, the <code>id</code> attribute of each &quot;sub&quot; document
and a separator. The default separator is &quot;/&quot; but it can specified
with the <code>path-sep</code> attribute:
</p>
<pre class="code-xml"><span class="hl kwa">&lt;multi</span><span class="hl std"> </span><span class="">path-sep</span><span class="hl std">=</span><span class="hl str">&quot;-&quot;</span><span class="hl std"> ...</span><span class="hl kwa">&gt;</span><span class="hl std">
  </span><span class="hl kwa">&lt;smallpost</span><span class="hl std"> </span><span class="">id</span><span class="hl std">=</span><span class="hl str">&quot;post1&quot;</span><span class="hl std"> ...</span><span class="hl kwa">&gt;</span><span class="hl std">...</span><span class="hl kwa">&lt;/smallpost</span><span class="hl kwa">&gt;</span><span class="hl std">
  </span><span class="hl kwa">&lt;smallpost</span><span class="hl std"> </span><span class="">id</span><span class="hl std">=</span><span class="hl str">&quot;post2&quot;</span><span class="hl std"> ...</span><span class="hl kwa">&gt;</span><span class="hl std">...</span><span class="hl kwa">&lt;/smallpost</span><span class="hl kwa">&gt;</span><span class="hl std">
  </span><span class="hl kwa">&lt;contents</span><span class="hl std"> </span><span class="">type</span><span class="hl std">=</span><span class="hl str">&quot;...&quot;</span><span class="hl kwa">&gt;</span><span class="hl std">...</span><span class="hl kwa">&lt;/contents</span><span class="hl kwa">&gt;</span><span class="hl std">
</span><span class="hl kwa">&lt;/multi</span><span class="hl kwa">&gt;</span><span class="hl std">
</span></pre>
<p>With the code above, the two &quot;smallpost&quot; documents will have paths
&quot;/smallposts-post1&quot; and &quot;/smallposts-post2&quot;. They can be refered to
for example with <span class="icode"><span class="hl kwa">&lt;doc</span><span class="hl kwa">&gt;</span></span> rule:
</p>
<pre class="code-xml"><span class="hl kwa">&lt;doc</span><span class="hl std"> </span><span class="">href</span><span class="hl std">=</span><span class="hl str">&quot;/smallposts-post1&quot;</span><span class="hl kwa">/&gt;</span></pre>

</div>

<div class="section"><div class="section-title" id="with-contents">Using &lt;with-contents/&gt;</div>
<p>
As any other document, one can use the <span class="icode"><span class="hl std">with-contents=&quot;true&quot;</span></span> attribute
to indicate that the body of the document is included in a <span class="icode"><span class="hl kwa">&lt;contents</span><span class="hl kwa">&gt;</span></span> node.
Here is an example using <span class="icode"><span class="hl std">with-contents=&quot;true&quot;</span></span> for the multi document,
for the rest of the definition of this documents and for one of the &quot;smallpost&quot; documents:
</p>
<pre class="code-xml"><span class="hl kwa">&lt;multi</span><span class="hl std"> </span><span class="">sets</span><span class="hl std">=</span><span class="hl str">&quot;smallposts&quot;</span><span class="hl std">
  </span><span class="">with-contents</span><span class="hl std">=</span><span class="hl str">&quot;true&quot;</span><span class="hl std">
</span><span class="hl kwa">&gt;</span><span class="hl std">
  </span><span class="hl com">&lt;!-- definition of a rule, shared by all documents --&gt;</span><span class="hl std">
  </span><span class="hl kwa">&lt;st</span><span class="hl std"> </span><span class="">foo</span><span class="hl std">=</span><span class="hl str">&quot;&quot;</span><span class="hl kwa">&gt;</span><span class="hl kwa">&lt;strong</span><span class="hl kwa">&gt;</span><span class="hl kwa">&lt;contents</span><span class="hl kwa">/&gt;</span><span class="hl kwa">&lt;/strong</span><span class="hl kwa">&gt;</span><span class="hl kwa">&lt;/st</span><span class="hl kwa">&gt;</span><span class="hl std">
  </span><span class="hl com">&lt;!-- body of the &quot;multi&quot; document --&gt;</span><span class="hl std">
  </span><span class="hl kwa">&lt;contents</span><span class="hl kwa">&gt;</span><span class="hl std">
    </span><span class="hl kwa">&lt;smallpost</span><span class="hl std"> </span><span class="">id</span><span class="hl std">=</span><span class="hl str">&quot;post1&quot;</span><span class="hl std"> </span><span class="">title</span><span class="hl std">=</span><span class="hl str">&quot;First post&quot;</span><span class="hl std"> </span><span class="">date</span><span class="hl std">=</span><span class="hl str">&quot;2014/01/21&quot;</span><span class="hl kwa">&gt;</span><span class="hl std">
      The first post, with path = &quot;</span><span class="hl kwa">&lt;doc-path</span><span class="hl kwa">/&gt;</span><span class="hl std">&quot;.
    </span><span class="hl kwa">&lt;/smallpost</span><span class="hl kwa">&gt;</span><span class="hl std">

    </span><span class="hl com">&lt;!-- this document defines a new rule &lt;name&gt;, using with-contents=&quot;true&quot;
      and a &lt;contents&gt; node. The new rule is available in this &quot;smallpost&quot;
      document only.
    --&gt;</span><span class="hl std">
    </span><span class="hl kwa">&lt;smallpost</span><span class="hl std"> </span><span class="">id</span><span class="hl std">=</span><span class="hl str">&quot;post2&quot;</span><span class="hl std"> </span><span class="">title</span><span class="hl std">=</span><span class="hl str">&quot;Second post&quot;</span><span class="hl std"> </span><span class="">date</span><span class="hl std">=</span><span class="hl str">&quot;2014/01/22&quot;</span><span class="hl std">
      </span><span class="">with-contents</span><span class="hl std">=</span><span class="hl str">&quot;true&quot;</span><span class="hl kwa">&gt;</span><span class="hl std">
      </span><span class="hl kwa">&lt;name</span><span class="hl std"> </span><span class="">foo</span><span class="hl std">=</span><span class="hl str">&quot;&quot;</span><span class="hl kwa">&gt;</span><span class="hl std">Name: </span><span class="hl kwa">&lt;st</span><span class="hl std"> </span><span class="">defer_</span><span class="hl std">=</span><span class="hl str">&quot;1&quot;</span><span class="hl kwa">&gt;</span><span class="hl kwa">&lt;contents</span><span class="hl kwa">/&gt;</span><span class="hl kwa">&lt;/st</span><span class="hl kwa">&gt;</span><span class="hl kwa">&lt;/name</span><span class="hl kwa">&gt;</span><span class="hl std">
      </span><span class="hl kwa">&lt;contents</span><span class="hl kwa">&gt;</span><span class="hl std">
        The second post, with path = &quot;</span><span class="hl kwa">&lt;doc-path</span><span class="hl kwa">/&gt;</span><span class="hl std">&quot;.
        </span><span class="hl kwa">&lt;name</span><span class="hl kwa">&gt;</span><span class="hl std">James Bond</span><span class="hl kwa">&lt;/name</span><span class="hl kwa">&gt;</span><span class="hl std">
      </span><span class="hl kwa">&lt;/contents</span><span class="hl kwa">&gt;</span><span class="hl std">
    </span><span class="hl kwa">&lt;/smallpost</span><span class="hl kwa">&gt;</span><span class="hl std">

  </span><span class="hl com">&lt;!-- The body of the final document with path &quot;smallposts&quot;.
    We use again with-contents=&quot;true&quot; do define a new rule
    &lt;hello&gt; for this document only.
  --&gt;</span><span class="hl std">
  </span><span class="hl kwa">&lt;contents</span><span class="hl std"> </span><span class="">type</span><span class="hl std">=</span><span class="hl str">&quot;page&quot;</span><span class="hl std"> </span><span class="">title</span><span class="hl std">=</span><span class="hl str">&quot;My small posts&quot;</span><span class="hl std">
    </span><span class="">with-contents</span><span class="hl std">=</span><span class="hl str">&quot;true&quot;</span><span class="hl kwa">&gt;</span><span class="hl std">
    </span><span class="hl kwa">&lt;hello</span><span class="hl std"> </span><span class="">name</span><span class="hl std">=</span><span class="hl str">&quot;&quot;</span><span class="hl kwa">&gt;</span><span class="hl std">Hello </span><span class="hl kwa">&lt;if</span><span class="hl std"> </span><span class="">name</span><span class="hl std">=</span><span class="hl str">&quot;&quot;</span><span class="hl kwa">&gt;</span><span class="hl kwa">&lt;dummy_</span><span class="hl kwa">&gt;</span><span class="hl std">world</span><span class="hl kwa">&lt;/dummy_</span><span class="hl kwa">&gt;</span><span class="hl kwa">&lt;name</span><span class="hl kwa">/&gt;</span><span class="hl kwa">&lt;/if</span><span class="hl kwa">&gt;</span><span class="hl std"> !</span><span class="hl kwa">&lt;/hello</span><span class="hl kwa">&gt;</span><span class="hl std">
    </span><span class="hl kwa">&lt;contents</span><span class="hl kwa">&gt;</span><span class="hl std">
      </span><span class="hl kwa">&lt;hello</span><span class="hl std"> </span><span class="">name</span><span class="hl std">=</span><span class="hl str">&quot;dear reader&quot;</span><span class="hl kwa">/&gt;</span><span class="hl std">
      This is the body of the document &quot;</span><span class="hl kwa">&lt;doc-path</span><span class="hl kwa">/&gt;</span><span class="hl std">&quot;.
      We can list our small posts here:
      </span><span class="hl kwa">&lt;documents</span><span class="hl std"> </span><span class="">type</span><span class="hl std">=</span><span class="hl str">&quot;smallpost&quot;</span><span class="hl std"> </span><span class="">set</span><span class="hl std">=</span><span class="hl str">&quot;smallposts&quot;</span><span class="hl kwa">/&gt;</span><span class="hl std">
    </span><span class="hl kwa">&lt;/contents</span><span class="hl kwa">&gt;</span><span class="hl std"> </span><span class="hl com">&lt;!-- contents of the body of the &quot;main&quot; document&quot; --&gt;</span><span class="hl std">
  </span><span class="hl kwa">&lt;/contents</span><span class="hl kwa">&gt;</span><span class="hl std"> </span><span class="hl com">&lt;!-- contents of the &quot;main&quot; document --&gt;</span><span class="hl std">
 </span><span class="hl kwa">&lt;/contents</span><span class="hl kwa">&gt;</span><span class="hl std"> </span><span class="hl com">&lt;!-- contents of the multi document --&gt;</span><span class="hl std">
</span><span class="hl kwa">&lt;/multi</span><span class="hl kwa">&gt;</span></pre>
<p>
The result is visible <a href="http://zoggy.github.io/stog/smallposts.html">here</a>.
</p>
</div>








<div id="footer">
<div class="generatedon">Generated on March 20, 2014 at 14h33</div>
</div>



</div> 
</body>
</html>
