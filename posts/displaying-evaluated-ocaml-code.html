<!DOCTYPE HTML>
<html>
<head>
<title>Stog : Displaying evaluated OCaml code</title><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<link rel="stylesheet" type="text/css" href="http://zoggy.github.com/stog/style.css"/>
</head><body>
<div id="page">
<div class="navbar navbar-fixed-top">
<div class="navbar-inner">
<div class="container">


  <ul class="nav">
    <li class="&lt;navbar-home/&gt;"><a href="http://zoggy.github.com/stog/index.html">Stog</a></li>
    <li class="&lt;navbar-install/&gt;"><a href="http://zoggy.github.com/stog/install.html">Installation</a></li>
    <li class="&lt;navbar-doc/&gt;"><a href="http://zoggy.github.com/stog/doc.html">Documentation</a></li>
    <li class="active"><a href="http://zoggy.github.com/stog/blog.html">Blog</a></li>
    <li class="&lt;navbar-about/&gt;"><a href="http://zoggy.github.com/stog/about.html">?</a></li>
  </ul>
  <div class="nav pull-right">

  </div>

</div>
</div>
</div>

<div id="header">
<div class="elt-navbar"><div class="navleft"><a href="http://zoggy.github.com/stog/posts/latex-in-stog.html">LaTeX in stog</a></div><div class="navright"><a href="http://zoggy.github.com/stog/posts/including-code-file.html">Including a code file (deferring evaluation)</a></div></div>
<div class="page-title">Displaying evaluated OCaml code</div>
</div>
<span/>
<div class="date">March 11, 2012</div>

<p>
Bytecode version of Stog, <span class="icode">stog.byte</span>,
offers the <span class="icode"><span class="hl kwa">&lt;ocaml-eval&gt;</span> ... <span class="hl kwa">&lt;/ocaml-eval&gt;</span>
</span>
function to evaluate code and display the result. This is nice to provide
verified code examples on your pages.
</p>

<p>
Example:
<pre class="code-xml"><span class="hl kwa">&lt;ocaml-eval&gt;</span>
let mylist = [ <span class="hl num">1</span> ; <span class="hl num">2</span> ; <span class="hl num">3</span> ; <span class="hl num">4</span>];;
<span class="hl kwa">&lt;/ocaml-eval&gt;</span>
</pre>
will display this: <pre class="code-ocaml"><div><span class="hl kwa">let</span> mylist <span class="hl opt">= [</span> <span class="hl num">1</span> <span class="hl opt">;</span> <span class="hl num">2</span> <span class="hl opt">;</span> <span class="hl num">3</span> <span class="hl opt">;</span> <span class="hl num">4</span><span class="hl opt">];;</span>
</div></pre>
</p>
<p>Adding the <span class="icode">toplevel=&quot;true&quot;</span> attribute will enable printing of the
toplevel result, so
<pre class="code-xml"><span class="hl kwa">&lt;ocaml-eval</span> <span class="hl kwb">toplevel</span>=<span class="hl str">&quot;true&quot;</span><span class="hl kwa">&gt;</span>
let mylist = [ <span class="hl num">1</span> ; <span class="hl num">2</span> ; <span class="hl num">3</span> ; <span class="hl num">4</span>];;<span class="hl kwa">&lt;/ocaml-eval&gt;</span>
</pre>
will display this: <pre class="code-ocaml"><div># <span class="hl kwa">let</span> mylist <span class="hl opt">= [</span> <span class="hl num">1</span> <span class="hl opt">;</span> <span class="hl num">2</span> <span class="hl opt">;</span> <span class="hl num">3</span> <span class="hl opt">;</span> <span class="hl num">4</span><span class="hl opt">];;</span>
</div><div class="ocaml-toplevel">val mylist : int list = [1; 2; 3; 4]</div></pre>
</p>
<p>
By default, <span class="icode">ocaml-eval</span> will stop Stog if an exception is
raised when evaluating code.
The <span class="icode">error-exc</span> attribute can be used to change this behaviour.
By default it is <span class="icode">&quot;true&quot;</span>, but
giving this attribute another value will result in printing the raised exception instead
of stopping Stog. This is useful when you want to show code raising exceptions, but still
don't want to let other piece of code fail silently.
<pre class="code-xml"><span class="hl kwa">&lt;ocaml-eval</span> <span class="hl kwb">toplevel</span>=<span class="hl str">&quot;true&quot;</span> <span class="hl kwb">error-exc</span>=<span class="hl str">&quot;false&quot;</span><span class="hl kwa">&gt;</span>
let mylist = [ <span class="hl num">1</span> ; <span class="hl num">2</span> ; <span class="hl num">3</span> ; <span class="hl num">4</span>];;
let mylist2 = [ <span class="hl num">1</span> ; <span class="hl num">2</span> ; <span class="hl num">3</span> ; <span class="hl str">&quot;hello&quot;</span>];;
<span class="hl kwa">&lt;/ocaml-eval&gt;</span>
</pre>
will display this: <pre class="code-ocaml"><div># <span class="hl kwa">let</span> mylist <span class="hl opt">= [</span> <span class="hl num">1</span> <span class="hl opt">;</span> <span class="hl num">2</span> <span class="hl opt">;</span> <span class="hl num">3</span> <span class="hl opt">;</span> <span class="hl num">4</span><span class="hl opt">];;</span>
</div><div class="ocaml-toplevel">val mylist : int list = [1; 2; 3; 4]</div><div># <span class="hl kwa">let</span> mylist2 <span class="hl opt">= [</span> <span class="hl num">1</span> <span class="hl opt">;</span> <span class="hl num">2</span> <span class="hl opt">;</span> <span class="hl num">3</span> <span class="hl opt">;</span> <span class="hl str">&quot;hello&quot;</span><span class="hl opt">];;</span>
</div><div class="ocaml-toplevel ocaml-exc">Line 1, characters 28-35:
Error: This expression has type string but an expression was expected of type
         int</div></pre>
Without <span class="icode">error-exc=&quot;false&quot;</span>, Stog would have failed with the
OCaml error message.
</p>


<div class="comments">
<div>
<div class="elt-keywords">
  <div class="bloc-keywords">
  Topics: <div class="keywords"><a href="http://zoggy.github.com/stog/topic_stog.html"><span itemprop="keywords">stog</span>
</a></div>
  </div>
  <div class="bloc-keywords">
  Keywords: <div class="keywords"><a href="http://zoggy.github.com/stog/kw_ocaml.html"><span itemprop="keywords">ocaml</span></a>, <a href="http://zoggy.github.com/stog/kw_evaluation.html"><span itemprop="keywords">evaluation</span></a>, <a href="http://zoggy.github.com/stog/kw_code.html"><span itemprop="keywords">code</span></a></div>
  </div>
</div>
</div>
<div itemprop="articleSection" class="section">
  <div id="disqus_thread"/>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'stog'; // required: replace example with your forum shortname
    var disqus_url = 'http://zoggy.github.com/stog/posts/displaying-evaluated-ocaml-code.html' ;
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>

</div>
</div>

</div>

<footer id="bottombar">
</footer>
</body>
</html>